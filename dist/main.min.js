!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).NumericPager=e()}(this,(function(){"use strict";const t={entriesSelector:".blog-entries",entrySelector:".entry",pagerSelector:".blog-pager",numberSelector:".pagination-numbers",numberClass:"pagination-item",dotsClass:"pagination-dots",activeClass:"is-active",totalVisibleNumbers:5,postPerPage:8,byDate:"false",maxResults:null,query:null,label:null,start:null,updatedMax:null};function e({config:t,currentPage:e,totalPages:s}){const{totalVisibleNumbers:n,activeClass:a}=t,r=function({currentPage:t,totalPages:e,totalVisibleNumbers:s}){const n=e,a=Math.floor(s/2);let r=Math.max(t-a,1),o=Math.min(r+s-1,n);return n<=s?(r=1,o=n):t<=a?(r=1,o=s):t>=n-a&&(r=n-s+1,o=n),Array.from({length:o-r+1},((t,e)=>r+e))}({currentPage:e,totalVisibleNumbers:n,totalPages:s}),o={number:"..."},l=r.map((t=>({number:t,activeClass:t===e?a:""})));if(e>1&&!r.includes(1)){const t={number:1,activeClass:""};l.unshift(o),l.unshift(t)}if(e<s&&!r.includes(s)){const t={number:s,activeClass:""};l.push(o),l.push(t)}return l}function s(t){const e=t.searchParams,s=t.pathname,n=Object.fromEntries(["max-results","by-date","updated-max","start","q"].map((t=>{const s="q"===t?"query":t.replace(/-([a-z])/g,((t,e)=>e.toUpperCase()));const n=e.get(t);return null!==n?[s,n]:null})).filter(Boolean)),a=(r=s).includes("/search/label/")?r.split("/").pop():null;var r;return a&&(n.label=a),n}function n(t){let e=5381;for(let s=0;s<t.length;s++)e=33*e^t.charCodeAt(s);return(e>>>0).toString(36)}function a(t=null,e=null){return e?`postData-query${n(e)}`:t?`postData-label${n(t)}`:"postData"}function r(t,e,s){const n=a(e,s);localStorage.setItem(n,JSON.stringify(t))}function o(t,e){const s=a(t,e);return JSON.parse(localStorage.getItem(s))||{}}function l({config:t,number:e,postDates:s}){const{homeUrl:n,label:a,query:r,maxResults:o,byDate:l}=t;if(1===e)return function({homeUrl:t,label:e,query:s,maxResults:n,byDate:a}){return e?`${t}/search/label/${e}?max-results=${n}`:s?`${t}/search?q=${s}&max-results=${n}&by-date=${a}`:t}({homeUrl:n,label:a,query:r,maxResults:o,byDate:l});const i=function(t,e,s){const n=(t-1)*s-1;return Array.isArray(e)&&e[n]?encodeURIComponent(e[n]):null}(e,s,o);return i?`${n}${function(t,e){return t?`/search/label/${t}?`:e?`/search?q=${e}&`:"/search?"}(a,r)}updated-max=${i}&max-results=${o}&start=${(e-1)*o}&by-date=${l}`:"#fetching"}function i({config:t,paginationData:e,postDates:s}){if(!e.length)return;const{numberContainer:n,numberClass:a,dotsClass:r}=t,o=document.createDocumentFragment();e.forEach((e=>{o.appendChild("..."===e.number?(()=>{const t=document.createElement("span");return t.className=r,t.textContent="...",t})():(({number:e,activeClass:n})=>{const r=document.createElement("a");return r.className=`${a} ${n}`.trim(),r.textContent=e,r.href=l({config:t,number:e,postDates:s}),r})(e))})),n.innerHTML="",n.appendChild(o)}function u({config:t,totalPosts:s,postDates:n}){const{maxResults:a}=t,r=function(t,e){return Math.ceil(Number(t)/e)}(s,a),o=function({config:t,postDates:e}){const{query:s,maxResults:n,updatedMax:a,start:r}=t;if(!a&&!r)return 1;const o=e.filter(((t,e)=>(e+1)%n==0)).indexOf(a);return(r&&s?Math.ceil(r/n)+1:null)??(-1!==o?o+2:null)??1}({config:t,postDates:n});i({config:t,paginationData:e({config:t,currentPage:o,totalPages:r}),postDates:n})}return class{constructor(e={}){this.currentUrl=new URL(window.location.href),this.config={...t,...e,...s(this.currentUrl)},this.pagerContainer=document.querySelector(this.config.pagerSelector),this.numberContainer=document.querySelector(this.config.numberSelector),this.entriesContainer=document.querySelector(this.config.entriesSelector)}async initPagination(){if(!this.pagerContainer||!this.numberContainer)return;const{totalVisibleNumbers:t,query:e,byDate:s,label:n,postPerPage:a,updatedMax:l,start:i,activeClass:c,numberClass:m,dotsClass:f}=this.config,b=o(e,n),{totalPosts:p=0,postDates:g=[],blogUpdated:d}=b,h=this.currentUrl.origin,y=this.getPostPerPage()||a,P={numberContainer:this.numberContainer,maxResults:y,homeUrl:h,query:e,label:n,totalVisibleNumbers:t,byDate:s,updatedMax:l,start:i,activeClass:c,numberClass:m,dotsClass:f};p&&g.length&&u({config:P,totalPosts:p,postDates:g});const $=await async function({homeUrl:t,query:e,label:s}){const n=`${t}/feeds/posts/summary/${s?`-/${s}?`:"?"}alt=json&max-results=0`,a=await fetch(n),l=await a.json(),i=Number(l.feed.openSearch$totalResults.$t),u=l.feed.updated.$t,c=o(e,s);return e||(c.totalPosts=i),c.blogUpdated=u,r(c,e,s),{totalPosts:i,blogUpdated:u}}({homeUrl:h,query:e,label:n});if($.blogUpdated!==d||!g.length){const t=await async function({config:t,totalPosts:e}){const{homeUrl:s,query:n,label:a,byDate:l}=t;if(0===e)return[];const i=Math.ceil(e/150);let u=0;const c=Array.from({length:i},((t,e)=>fetch(`${s}/feeds/posts/summary/${n?`?q=${n}&orderby=${!1===l?"relevance":"published"}&`:a?`-/${a}?`:"?"}alt=json&max-results=150&start-index=${150*e+1}`).then((t=>t.json())))),m=(await Promise.all(c)).flatMap((t=>(n&&(u+=Number(t.feed.openSearch$totalResults.$t)),t.feed.entry?.map((t=>t.published.$t.replace(/\.\d+/,"")))||[]))),f=o(n,a);return f.postDates=m,n&&(f.totalPosts=u),r(f,n,a),{totalPosts:n?u:e,postDates:m}}({config:P,totalPosts:$.totalPosts});u({config:P,totalPosts:t.totalPosts,postDates:t.postDates})}a>=$.totalPosts&&this.pagerContainer.remove()}getPostPerPage(){const{maxResults:t,entrySelector:e}=this.config,s=this.entriesContainer?.querySelectorAll(e).length;return Number(t)||s||null}}}));